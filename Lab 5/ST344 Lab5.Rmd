---
title: "<center> <h1>COVID--19</h1> </center><center> <h4>The statistical investigative cycle</h4> </center>"
author: "<center>Author - 1826475</center>"
date: "<center>Date - 11/11/2020</center>"
output: pdf_document
---
***

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, fig.width = 8, fig.height = 5, message = FALSE)
```

```{r Formatting}
library(dplyr)
library(readxl)
CovidData <- read.csv("tidycovid19.csv")

library(lubridate)
CovidData <- CovidData %>%
  mutate(date = as.Date(parse_date_time(CovidData$date,orders=c("y","ym","ymd"))))

UKCaseData <- {CovidData %>% 
    filter(country == "United Kingdom") %>%
    select(date, confirmed) }
```

```{r DailyCases}
firstdiff <- function(x) {
  shifted <- c(0,x[1:(length(x)-1)])
  result = x-shifted
  which_negative = which(result<0)
  result[which_negative] = NA
  return(result)
}

UKCaseData <- UKCaseData %>%
  mutate(daily_confirmed = firstdiff(confirmed))
```


### Introduction

This piece will focus on the analysis of the spread of COVID--19 in the United Kingdom (UK). It is no secret the UK has handled this disease poorly with more than 1 million cases and 50 thousand deaths. Furthermore, the monthly GDP and service industries still sit around 9% below the level of February 2020. With a second lockdown incoming, let us take a look at the numbers that tell the tale for the UK in the COVID--19 epoch.

The early period is always the most important in terms of determining the trend of the disease. To understand why we must first understand some key epidemiology terminology:

#### Background Understanding

Effective reproduction number, denoted by $R$, accounts for growing immunity over time and is the expected number of secondary cases generated by a single case in a population through which the disease is spreading. (*Note: The simplest model for the case is discussed later in this piece.*)

The salient point about $R$ under the simplest model is this: if $R>1$ then exponential growth in the number of cases will occur; if $R<1$ then exponential decrease the number of cases will occur. Therefore, how a country deals with a disease in its "first stage" could be the key to controlling a disease outbreak or the reason for succumbing to it.

#### Data

For the COVID--19, the $R$ value is quoted by (Sanche et al. 2020) to be in the region of 2--6, which is greater than 1 and hence seems to suggest an exponential growth; we will this explore graphically over this piece.

First and foremost we must define a time period that best represents the early period of the outbreak. I chose to define this crucial "first--period" period for the UK to be defined from the 24th February 2020 to the 23rd March 2020. To provide some context, this period in the UK refers to an interval that succeeds the initial outbreak of the virus in the UK and precedes the first nationwide lockdown imposed to control spread. Hence, this piece seeks to study, graph and analyze confirmed cases during the first stage of the COVID--19 global epidemic in the UK.

The data considered here is form the `tidycovid19` dataset which stores values for different variables concerning the  Covid-19 pandemic for countries around the globe. For a more detailed description of the package and the variables contained please click [here](https://joachim-gassen.github.io/tidycovid19/).


### Producing Plots and Formal Modelling

```{r Date}
FirstStageUKCaseData <- {UKCaseData %>% 
    filter( (date > as.Date("2020-02-23")) & (date < as.Date("2020-03-24")) )}
```

We suspect exponential growth from the epidemiology theory discussed above. Now, to keep it simple we shall examine the simplest model possible, where an individual in the population infects $R$ individuals at a particular time $T$~c~ after they got infected themselves (referred to as "generation interval"). The limitation of this model is that the generation interval is rigid while a more complex and accurate model would utilize a complex probability distribution. The distribution in our case is simply a point mass Dirac delta distribution at $T$~c~. However, this does ensures that the generation interval is not random in this study we give it the the value of $T$~c~ stated above.

For COVID-19 we take $T$~c~$=4$, which is a mean quoted in a study by (Nishiura, Linton, and Akhmetzhanov 2020). Now, in this study I will take the approach that we model the number I(t) of infected individuals at time t using the equation: $I(t) = I(0)*R^{t/}$^$T$~c~^

Which is equivalent to: $I(t) = I(0)*exp(rt)$, where $r = log(R)T$~c~ and hence, $R = exp(r)T$~c~. Furthermore, note that the doubling time, which is the number of days taken for cases to double, is given by $log(2)/r$.

Modeling the growth of infections in this manner gives a linear model for the log of infections: $log[I(t)] = log[I(0)] + rt$. The count data suggests to the fact that a Poisson distribution with mean rate I(t) would be apt. Following on from the use of a linear model for the log of this Poisson rate, I utilized a Poisson generalized linear model (GLM) to depict the regression for the data. Hence, giving us a log link function, with the log expectation $log(E[I|t])$ of the Poisson being given by $a+rt$, with parameters $a$ and $r$.

Now, to confirm this linear trend we shall plot the log of confirmed cases against time for the period 24th February 2020 -- 23rd March 2020.

```{r Plot2}
library(MASS)
library(ggplot2)
negative_binomial_fit <- glm.nb(daily_confirmed ~ 1 + date, data = FirstStageUKCaseData)

FirstStageUKCaseData$pred_negative_binomial = predict(negative_binomial_fit)

early_plot_log_confirmed_date <- {FirstStageUKCaseData %>% ggplot(aes(x = date, y = log(daily_confirmed)))} + labs(title = "Confirmed cases increase exponentially over a 1 month period from 23/02/20 - 23/03/20", x = "Date", y = "log(Confirmed cases)", caption = "(based on data by JHU CSSE)", subtitle = "The red line is a continuous regression that depicts the trend of the plot.") + scale_x_date(date_breaks = "weeks", date_labels = "%d-%m-%y") +
  geom_point() +
  geom_line(aes(y = pred_negative_binomial), size = 1, color = "red")
print(early_plot_log_confirmed_date)
```

The data points a clearly noisy but the linear red line suggests that this model is very reasonable and that the rise in cases do indeed follow an exponential growth for this period. This fit tells us that the $r = 0.223726$ which corresponds to a doubling time of just over 3 days, and an estimated $R$ of 2.45, which is greater than 1. Both these facts are in agreement with the exponential trend of the curve.

In conclusion, the initial $R$ epidemiological theory suggested an exponential growth in the UK which was backed up by the data when plotted the log of confirmed cases against time for the period 24th February 2020 -- 23rd March 2020. This seems to indicate not enough was done on the part of the government to control the disease in the early days to control the spread, perhaps sprouting questions as to why a lockdown was not imposed sooner when a deeper understanding of the disease was still absent. In light of a second nationwide lockdown being imposed, the UK will look back at this pivotal period with slight regret and hence will become another case where epidemiology showed the world where it went wrong.


### References

Gassen, J., 2020. Download, Tidy And Visualize Covid-19 Related Data. [online] Joachim-gassen.github.io. Available at: <https://joachim-gassen.github.io/tidycovid19/> [Accessed 12 November 2020].

Nishiura, H., N. M. Linton, and A. R. Akhmetzhanov. 2020. “Serial Interval of Novel Coronavirus (Covid-19) Infections.” International Journal of Infectious Diseases 93: 284–86.

Sanche, S., Y. T. Lin, C. Xu, E. Romero-Severson, E. Hengartner, and R. Ke. 2020. “High Contagiousness and Rapid Spread of Severe Acute Respiratory Syndrome Coronavirus 2.” Emerging Infectious Diseases 26 (7): 1470–7.

Wallinga, J., and M. Lipsitch. 2006. “How Generation Intervals Shape the Relationship Between Growth Rates and Reproductive Numbers.” Proc. R. Soc. B. 274: 599–604.

Zeileis, A., C. Kleiber, and S. Jackman. 2007. “Regression Models for Count Data in R.” Journal of Statistical Software 27 (8): 1–25.
